<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   viewBox="0 0 354.6402 221.17432"
   width="354.6402"
   height="221.17432"
   version="1.1"
   id="svg81"
   sodipodi:docname="neural_logic_string_diagram.svg"
   inkscape:version="1.4.2 (ebf0e94, 2025-05-08)"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview81"
     pagecolor="#ffffff"
     bordercolor="#000000"
     borderopacity="0.25"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#ffffff"
     inkscape:zoom="0.5"
     inkscape:cx="-103"
     inkscape:cy="279"
     inkscape:window-width="1080"
     inkscape:window-height="1897"
     inkscape:window-x="0"
     inkscape:window-y="0"
     inkscape:window-maximized="1"
     inkscape:current-layer="svg81"
     showborder="false" />
  <line
     x1="-272.64932"
     y1="448.47604"
     x2="-232.64932"
     y2="448.47604"
     stroke="#9c27b0"
     stroke-width="3"
     id="line36" />
  <line
     x1="-112.64932"
     y1="448.47604"
     x2="-32.649319"
     y2="448.47604"
     stroke="#795548"
     stroke-width="3"
     marker-end="url(#arrow-brown)"
     id="line38" />
  <path
     id="line31"
     style="stroke:#673ab7;stroke-width:3;marker-end:url(#arrow-indigo)"
     d="m -104.64932,373.47604 h 62.000001"
     sodipodi:nodetypes="cc" />
  <path
     id="line45"
     style="stroke:#673ab7;stroke-width:4;marker-end:url(#arrow-indigo)"
     d="m 141.35069,409.47604 h 63.99999"
     sodipodi:nodetypes="cc" />
  <line
     x1="37.350681"
     y1="902.47607"
     x2="37.350681"
     y2="972.47607"
     stroke="#b71c1c"
     stroke-width="6"
     marker-end="url(#arrow-red)"
     id="line62"
     style="stroke-width:5;stroke-linecap:butt;stroke-linejoin:round;stroke-dasharray:none;marker-end:url(#arrow-red)" />
  <!-- Title -->
  <text
     x="-476.64929"
     y="-3.5239563"
     font-size="18"
     font-weight="bold"
     text-anchor="middle"
     fill="#333333"
     id="text1"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:32px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal"><tspan
       style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-family:'DejaVu Serif';-inkscape-font-specification:'DejaVu Serif Bold'"
       id="tspan87">Neural Logic Network: String Diagram (Category Theory Style)</tspan></text>
  <!-- Legend -->
  <rect
     x="-583.24261"
     y="33.099899"
     width="318.76248"
     height="102.57288"
     fill="#f5f5f5"
     stroke="#999999"
     stroke-width="1"
     rx="3"
     id="rect2" />
  <text
     x="-547.24261"
     y="63.099899"
     font-size="11px"
     font-weight="bold"
     id="text3"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Legend:</text>
  <line
     x1="-547.24261"
     y1="87.099899"
     x2="-507.24261"
     y2="87.099899"
     stroke="#2196f3"
     stroke-width="3"
     id="line3" />
  <text
     x="-502.24261"
     y="91.099899"
     font-size="10px"
     id="text4"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">= Data wire (tensor)</text>
  <rect
     x="-547.24261"
     y="102.0999"
     width="40"
     height="20"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1.5"
     rx="2"
     id="rect4" />
  <text
     x="-502.24261"
     y="118.0999"
     font-size="10px"
     id="text5"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">= Operation (function)</text>
  <!-- INPUT: Working Memory -->
  <text
     x="-1056.6493"
     y="340.47604"
     font-size="13"
     font-weight="bold"
     fill="#1565c0"
     id="text6"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">INPUT</text>
  <text
     x="-1056.6493"
     y="366.47604"
     font-size="11"
     fill="#666666"
     id="text7"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;line-height:1;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal"><tspan
       sodipodi:role="line"
       id="tspan85"
       x="-1056.6493"
       y="366.47604"
       style="line-height:1">Working</tspan><tspan
       sodipodi:role="line"
       id="tspan86"
       x="-1056.6493"
       y="387.80936"
       style="line-height:1">Memory</tspan></text>
  <text
     x="-1056.6493"
     y="413.47604"
     font-size="10"
     font-family="monospace"
     fill="#444444"
     id="text8"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">(batch, W, L)</text>
  <path
     id="line8"
     style="stroke:#2196f3;stroke-width:4;marker-end:url(#arrow-blue)"
     d="m -912.64932,362.47604 h 168"
     sodipodi:nodetypes="cc" />
  <text
     x="-878.64929"
     y="349.47604"
     font-size="9"
     text-anchor="middle"
     fill="#1565c0"
     id="text9"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">WM</text>
  <!-- RULE PROCESSING (for one rule) -->
  <rect
     x="-828.36798"
     y="234.2049"
     width="1295"
     height="707.99994"
     fill="none"
     stroke="#9c27b0"
     stroke-width="2"
     stroke-dasharray="5, 5"
     rx="5"
     id="rect9" />
  <text
     x="-201.65952"
     y="213.24567"
     font-size="12"
     font-weight="bold"
     text-anchor="middle"
     fill="#9c27b0"
     id="text10"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Single Rule Processing (repeat M times)</text>
  <!-- FOR EACH PREMISE j -->
  <rect
     x="-802.64929"
     y="298.47604"
     width="480"
     height="330"
     fill="#fff3e0"
     fill-opacity="0.3"
     stroke="#f57c00"
     stroke-width="1.5"
     stroke-dasharray="3, 3"
     rx="20.838949"
     id="rect10"
     ry="19.979612" />
  <text
     x="-598.32721"
     y="654.42102"
     font-size="11"
     font-weight="bold"
     text-anchor="middle"
     fill="#f57c00"
     id="text11"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">For each premise j ∈ {1..J}</text>
  <path
     id="line14"
     style="stroke:#2196f3;stroke-width:2;stroke-dasharray:2, 2"
     d="m -772.64929,362.47604 v 146"
     sodipodi:nodetypes="cc" />
  <text
     x="-761.64929"
     y="476.47604"
     font-size="8"
     fill="#666666"
     id="text14"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">copy</text>
  <rect
     x="-743.35266"
     y="334.90826"
     width="132.13048"
     height="59.276257"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1.5"
     rx="3"
     id="rect14" />
  <text
     x="-676.64929"
     y="358.47604"
     font-size="10"
     font-weight="bold"
     text-anchor="middle"
     id="text15"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Match Score</text>
  <text
     x="-670.64929"
     y="427.47604"
     font-size="8"
     text-anchor="middle"
     id="text16"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Σ(1-γ[j,l])·(c[j,l]-WM[:,:,l])²</text>
  <text
     x="-676.64929"
     y="385.47604"
     font-size="7"
     text-anchor="middle"
     fill="#666666"
     id="text17"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">for l ∈ {1..L}</text>
  <circle
     cx="-706.64929"
     cy="334.47604"
     r="3"
     fill="#e91e63"
     id="circle17" />
  <path
     id="line17"
     style="stroke:#e91e63;stroke-width:2"
     d="m -706.64932,330.47604 v -46"
     sodipodi:nodetypes="cc" />
  <text
     x="-725.64929"
     y="274.47604"
     font-size="9"
     fill="#e91e63"
     font-weight="bold"
     id="text18"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">γ[j,:]</text>
  <circle
     cx="-652.64929"
     cy="334.47604"
     r="3"
     fill="#e91e63"
     id="circle18" />
  <path
     id="line18"
     style="stroke:#e91e63;stroke-width:2"
     d="m -652.64932,330.47604 v -46"
     sodipodi:nodetypes="cc" />
  <text
     x="-669.64929"
     y="274.47604"
     font-size="9"
     fill="#e91e63"
     font-weight="bold"
     id="text19"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">c[j,:]</text>
  <path
     id="line19"
     style="stroke:#4caf50;stroke-width:3;marker-end:url(#arrow-green)"
     d="m -610.64929,363.47604 h 54"
     sodipodi:nodetypes="cc" />
  <text
     x="-582.64929"
     y="324.47604"
     font-size="8"
     text-anchor="middle"
     fill="#4caf50"
     id="text20"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">(batch,W)</text>
  <rect
     x="-550.50861"
     y="339.1947"
     width="97.859314"
     height="51.416916"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1.5"
     rx="3"
     id="rect20" />
  <text
     x="-502.64929"
     y="360.47604"
     font-size="10"
     font-weight="bold"
     text-anchor="middle"
     id="text21"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Softmax</text>
  <text
     x="-502.64929"
     y="381.47604"
     font-size="8"
     text-anchor="middle"
     id="text22"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">-scores/τ</text>
  <path
     id="line22"
     style="stroke:#ff9800;stroke-width:3;marker-end:url(#arrow-orange)"
     d="m -452.64932,363.47604 h 52"
     sodipodi:nodetypes="cc" />
  <text
     x="-424.64932"
     y="322.47604"
     font-size="8"
     text-anchor="middle"
     fill="#ff9800"
     id="text23"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">α (batch,W)</text>
  <rect
     x="-399.07132"
     y="338.48114"
     width="106.422"
     height="54.994904"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1.5"
     rx="3"
     id="rect23" />
  <text
     x="-342.64932"
     y="359.47604"
     font-size="10"
     font-weight="bold"
     text-anchor="middle"
     id="text24"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Einsum</text>
  <text
     x="-342.64932"
     y="382.47604"
     font-size="8"
     text-anchor="middle"
     id="text25"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">bw,bwl→bl</text>
  <line
     x1="-772.64929"
     y1="508.47604"
     x2="-342.64932"
     y2="508.47604"
     stroke="#2196f3"
     stroke-width="3"
     id="line25" />
  <line
     x1="-342.64932"
     y1="508.47604"
     x2="-342.64932"
     y2="393.47604"
     stroke="#2196f3"
     stroke-width="3"
     id="line26" />
  <path
     id="line27"
     style="stroke:#9c27b0;stroke-width:4;marker-end:url(#arrow-purple)"
     d="m -292.64932,368.47604 h 50"
     sodipodi:nodetypes="cc" />
  <text
     x="-246.64932"
     y="301.47604"
     font-size="9"
     text-anchor="middle"
     fill="#9c27b0"
     id="text27"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">best_prop</text>
  <text
     x="-248.64932"
     y="326.47604"
     font-size="8"
     text-anchor="middle"
     fill="#9c27b0"
     id="text28"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">(batch,L)</text>
  <rect
     x="-223.35269"
     y="342.76758"
     width="129.83899"
     height="60.562683"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1.5"
     rx="3"
     id="rect28" />
  <text
     x="-162.64932"
     y="366.47604"
     font-size="10"
     font-weight="bold"
     text-anchor="middle"
     id="text29"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Body[j]</text>
  <text
     x="-162.64932"
     y="388.47604"
     font-size="8"
     text-anchor="middle"
     id="text30"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Linear(L→I)</text>
  <circle
     cx="-162.64932"
     cy="340.47604"
     r="3"
     fill="#e91e63"
     id="circle30" />
  <path
     id="line30"
     style="stroke:#e91e63;stroke-width:2"
     d="m -162.64932,338.47604 v -63"
     sodipodi:nodetypes="cc" />
  <text
     x="-203.64932"
     y="267.47604"
     font-size="9"
     fill="#e91e63"
     font-weight="bold"
     id="text31"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">W_body[j]</text>
  <text
     x="-64.649323"
     y="304.47604"
     font-size="8"
     text-anchor="middle"
     fill="#673ab7"
     id="text32"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">vars[j]</text>
  <text
     x="-64.649323"
     y="329.47604"
     font-size="8"
     text-anchor="middle"
     fill="#673ab7"
     id="text33"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">(batch,I)</text>
  <rect
     x="-236.91031"
     y="417.76758"
     width="144.95419"
     height="65.708466"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1.5"
     rx="3"
     id="rect33" />
  <text
     x="-162.64932"
     y="443.47604"
     font-size="10"
     font-weight="bold"
     text-anchor="middle"
     id="text34"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">SlotSelect[j]</text>
  <text
     x="-162.64932"
     y="471.47604"
     font-size="8"
     text-anchor="middle"
     id="text35"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Linear(L→L×I)</text>
  <path
     id="line35"
     style="stroke:#9c27b0;stroke-width:3"
     d="m -272.64932,368.47604 v 82"
     sodipodi:nodetypes="cc" />
  <circle
     cx="-162.64932"
     cy="483.47604"
     r="3"
     fill="#e91e63"
     id="circle36" />
  <path
     id="line37"
     style="stroke:#e91e63;stroke-width:2"
     d="m -162.79001,544.83182 v -60"
     sodipodi:nodetypes="cc" />
  <text
     x="-201.49844"
     y="570.20795"
     font-size="9"
     fill="#e91e63"
     font-weight="bold"
     id="text37"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">W_slot[j]</text>
  <text
     x="-52.649323"
     y="529.47607"
     font-size="8"
     text-anchor="middle"
     fill="#795548"
     id="text38"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">slots[j]</text>
  <text
     x="-52.649323"
     y="506.47604"
     font-size="8"
     text-anchor="middle"
     fill="#795548"
     id="text39"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">(batch,L,I)</text>
  <rect
     x="-27.925568"
     y="338.90826"
     width="187.80836"
     height="128"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1.5"
     rx="3"
     id="rect39"
     style="fill:#ffffff" />
  <!-- ACCUMULATE across premises -->
  <text
     x="71.350685"
     y="366.47604"
     font-size="10"
     font-weight="bold"
     text-anchor="middle"
     id="text40"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Accumulate</text>
  <text
     x="71.350685"
     y="387.47604"
     font-size="9"
     text-anchor="middle"
     id="text41"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Σ over j</text>
  <text
     x="71.350685"
     y="407.47604"
     font-size="8"
     text-anchor="middle"
     fill="#666666"
     id="text42"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">captured_vars</text>
  <text
     x="71.350685"
     y="430.47604"
     font-size="8"
     text-anchor="middle"
     fill="#666666"
     id="text43"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">+= γ_avg·vars[j]</text>
  <text
     x="71.350685"
     y="453.47604"
     font-size="8"
     text-anchor="middle"
     fill="#666666"
     id="text44"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">+= slots[j]·props</text>
  <path
     d="m 17.350683,468.47604 v 130 H -772.64932 v -82"
     stroke="#f57c00"
     stroke-width="2"
     fill="none"
     marker-end="url(#arrow-orange)"
     stroke-dasharray="3, 3"
     id="path44"
     sodipodi:nodetypes="cccc" />
  <text
     x="-212.64932"
     y="619.47607"
     font-size="9"
     text-anchor="middle"
     fill="#f57c00"
     id="text45"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">loop j=1..J</text>
  <text
     x="209.35068"
     y="324.47604"
     font-size="9"
     text-anchor="middle"
     fill="#673ab7"
     id="text46"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">captured</text>
  <text
     x="219.35068"
     y="347.47604"
     font-size="8"
     text-anchor="middle"
     fill="#673ab7"
     id="text47"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">(batch,I)</text>
  <!-- HEAD network -->
  <rect
     x="219.41183"
     y="381.48114"
     width="225.58614"
     height="53.567749"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1.5"
     rx="3"
     id="rect47" />
  <text
     x="329.35068"
     y="404.47604"
     font-size="10"
     font-weight="bold"
     text-anchor="middle"
     id="text48"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Head</text>
  <text
     x="329.35068"
     y="424.47604"
     font-size="8"
     text-anchor="middle"
     id="text49"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Linear(I→output_dim)</text>
  <circle
     cx="337.35068"
     cy="380.47604"
     r="3"
     fill="#e91e63"
     id="circle49" />
  <path
     id="line49"
     style="stroke:#e91e63;stroke-width:2"
     d="m 337.35068,380.47604 v -97"
     sodipodi:nodetypes="cc" />
  <text
     x="304.35068"
     y="267.47604"
     font-size="9"
     fill="#e91e63"
     font-weight="bold"
     id="text50"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">W_head</text>
  <path
     id="line50"
     style="fill:none;stroke:#d32f2f;stroke-width:4"
     d="m 158.72683,650.17434 h 180 V 435.17431"
     sodipodi:nodetypes="ccc" />
  <text
     x="234.35068"
     y="538.47607"
     font-size="9"
     fill="#d32f2f"
     id="text51"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">rule_out</text>
  <text
     x="166.35068"
     y="567.47607"
     font-size="8"
     fill="#d32f2f"
     id="text52"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">(batch,out_dim)</text>
  <!-- CONFIDENCE weighting -->
  <rect
     x="-61.171291"
     y="617.91333"
     width="215.60651"
     height="61.416939"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1.5"
     rx="3"
     id="rect52" />
  <text
     x="42.350681"
     y="642.47607"
     font-size="10"
     font-weight="bold"
     text-anchor="middle"
     id="text53"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Confidence</text>
  <text
     x="42.350681"
     y="666.47607"
     font-size="8"
     text-anchor="middle"
     id="text54"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">exp(-match_quality)</text>
  <path
     id="line54"
     style="fill:none;stroke:#4caf50;stroke-width:2"
     d="m -374.64932,392.47604 v 257 h 314.000003"
     sodipodi:nodetypes="ccc" />
  <path
     d="M -42.649317,883.47604 H -912.64932 v -501"
     stroke="#9c27b0"
     stroke-width="2.5"
     fill="none"
     marker-end="url(#arrow-purple)"
     stroke-dasharray="5, 5"
     id="path61"
     sodipodi:nodetypes="ccc"
     style="marker-end:url(#arrow-indigo)" />
  <text
     x="-218.64932"
     y="676.47607"
     font-size="8"
     text-anchor="middle"
     fill="#4caf50"
     id="text55"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">match_quality</text>
  <line
     x1="37.350681"
     y1="743.47607"
     x2="37.350681"
     y2="838.47607"
     stroke="#b71c1c"
     stroke-width="5"
     marker-end="url(#arrow-red)"
     id="line58" />
  <circle
     cx="37.350681"
     cy="738.47607"
     r="15"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="1.5"
     id="circle55" />
  <text
     x="37.350681"
     y="746.47607"
     font-size="16"
     text-anchor="middle"
     id="text56"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">×</text>
  <line
     x1="37.350681"
     y1="678.47607"
     x2="37.350681"
     y2="723.47607"
     stroke="#d32f2f"
     stroke-width="3"
     id="line57" />
  <text
     x="57.350681"
     y="788.47607"
     font-size="9"
     fill="#b71c1c"
     id="text58"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">weighted_out</text>
  <text
     x="57.350681"
     y="813.47607"
     font-size="8"
     fill="#b71c1c"
     id="text59"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">(batch,out_dim)</text>
  <rect
     x="-64.035675"
     y="852.76758"
     width="207.05406"
     height="55.708462"
     fill="#ffffff"
     stroke="#333333"
     stroke-width="2"
     rx="3"
     id="rect59" />
  <!-- SUM across all rules -->
  <text
     x="35.350681"
     y="874.47607"
     font-size="11"
     font-weight="bold"
     text-anchor="middle"
     id="text60"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Sum Rules</text>
  <text
     x="39.350681"
     y="897.47607"
     font-size="9"
     text-anchor="middle"
     id="text61"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Σ over m ∈ {1..M}</text>
  <text
     x="-506.64929"
     y="910.47607"
     font-size="10"
     text-anchor="middle"
     fill="#9c27b0"
     font-weight="bold"
     id="text62"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">loop m=1..M (repeat for each rule)</text>
  <!-- FINAL OUTPUT -->
  <text
     x="37.350681"
     y="1008.4761"
     font-size="13"
     font-weight="bold"
     text-anchor="middle"
     fill="#b71c1c"
     id="text63"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">OUTPUT</text>
  <text
     x="37.350681"
     y="1028.4761"
     font-size="11"
     text-anchor="middle"
     fill="#666666"
     id="text64"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Final Prediction</text>
  <text
     x="37.350681"
     y="1046.4761"
     font-size="10"
     font-family="monospace"
     text-anchor="middle"
     fill="#444444"
     id="text65"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">(batch, output_dim)</text>
  <!-- Annotations -->
  <text
     x="-1035.948"
     y="39.817505"
     font-size="10px"
     fill="#666666"
     font-style="italic"
     id="text66"
     style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:'Alibaba PuHuiTi';-inkscape-font-specification:'Alibaba PuHuiTi, Medium';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;fill:#000000"><tspan
       style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:'Alibaba PuHuiTi';-inkscape-font-specification:'Alibaba PuHuiTi, Medium';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;fill:#000000"
       id="tspan83">Key innovations:</tspan></text>
  <text
     x="-1035.948"
     y="68.995483"
     font-size="9px"
     fill="#666666"
     id="text67"
     style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:'Alibaba PuHuiTi';-inkscape-font-specification:'Alibaba PuHuiTi, Medium';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;fill:#000000"><tspan
       style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:'Alibaba PuHuiTi';-inkscape-font-specification:'Alibaba PuHuiTi, Medium';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;fill:#000000"
       id="tspan84">• γ learns constant vs variable</tspan></text>
  <text
     x="-1035.948"
     y="98.344238"
     font-size="9px"
     fill="#666666"
     id="text68"
     style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:'Alibaba PuHuiTi';-inkscape-font-specification:'Alibaba PuHuiTi, Medium';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;fill:#000000">• Soft attention = differentiable</text>
  <text
     x="-1035.948"
     y="123.5542"
     font-size="9px"
     fill="#666666"
     id="text69"
     style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:'Alibaba PuHuiTi';-inkscape-font-specification:'Alibaba PuHuiTi, Medium';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;fill:#000000">• Variable capture via unification</text>
  <text
     x="-1035.948"
     y="152.8175"
     font-size="9px"
     fill="#666666"
     id="text70"
     style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:'Alibaba PuHuiTi';-inkscape-font-specification:'Alibaba PuHuiTi, Medium';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;fill:#000000">• Confidence weighting by match</text>
  <!-- Arrow markers -->
  <defs
     id="defs76">
    <rect
       x="24.260958"
       y="797.75739"
       width="211.21304"
       height="208.35883"
       id="rect82" />
    <marker
       id="arrow-blue"
       markerWidth="5"
       markerHeight="5"
       refX="9"
       refY="3"
       orient="auto"
       markerUnits="strokeWidth"
       viewBox="0 0 10 6"
       preserveAspectRatio="none">
      <polygon
         points="0,6 0,0 10,3 "
         fill="#2196f3"
         id="polygon70" />
    </marker>
    <marker
       id="arrow-green"
       markerWidth="6"
       markerHeight="6"
       refX="9"
       refY="3"
       orient="auto"
       viewBox="0 0 10 6"
       preserveAspectRatio="none">
      <polygon
         points="0,6 0,0 10,3 "
         fill="#4caf50"
         id="polygon71" />
    </marker>
    <marker
       id="arrow-orange"
       markerWidth="6"
       markerHeight="6"
       refX="9"
       refY="3"
       orient="auto"
       preserveAspectRatio="none">
      <polygon
         points="0,6 0,0 10,3 "
         fill="#ff9800"
         id="polygon72" />
    </marker>
    <marker
       id="arrow-purple"
       markerWidth="5"
       markerHeight="5"
       refX="3"
       refY="3"
       orient="auto"
       preserveAspectRatio="none"
       markerUnits="strokeWidth"
       viewBox="0 0 10 6">
      <polygon
         points="0,6 0,0 10,3 "
         fill="#9c27b0"
         id="polygon73" />
    </marker>
    <marker
       id="arrow-indigo"
       markerWidth="6"
       markerHeight="6"
       refX="4"
       refY="3"
       orient="auto"
       preserveAspectRatio="none"
       viewBox="0 0 10 6">
      <polygon
         points="0,6 0,0 10,3 "
         fill="#673ab7"
         id="polygon74" />
    </marker>
    <marker
       id="arrow-brown"
       markerWidth="10"
       markerHeight="6"
       refX="9"
       refY="3"
       orient="auto"
       viewBox="0 0 10 6"
       preserveAspectRatio="xMidYMid">
      <polygon
         points="0,6 0,0 10,3 "
         fill="#795548"
         id="polygon75" />
    </marker>
    <marker
       id="arrow-red"
       markerWidth="4"
       markerHeight="4"
       refX="4"
       refY="3"
       orient="auto"
       preserveAspectRatio="none"
       viewBox="0 0 10 6"
       markerUnits="strokeWidth">
      <polygon
         points="0,6 0,0 10,3 "
         fill="#b71c1c"
         id="polygon76" />
    </marker>
  </defs>
  <!-- Learnable parameters highlight box -->
  <rect
     x="137"
     y="-23"
     width="352.6402"
     height="219.17432"
     fill="#ffebee"
     stroke="#e91e63"
     stroke-width="2"
     rx="3"
     id="rect76" />
  <text
     x="283.35071"
     y="12.476044"
     font-size="11"
     font-weight="bold"
     text-anchor="middle"
     fill="#e91e63"
     id="text76"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">Learnable Parameters</text>
  <text
     x="223.35071"
     y="43.436073"
     font-size="9"
     fill="#c2185b"
     id="text77"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">• γ[j,l] - cylindrification</text>
  <text
     x="223.35071"
     y="75.196068"
     font-size="9"
     fill="#c2185b"
     id="text78"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">• c[j,l] - constants</text>
  <text
     x="223.35071"
     y="106.95605"
     font-size="9"
     fill="#c2185b"
     id="text79"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">• W_body[j] - capture</text>
  <text
     x="223.35071"
     y="138.71605"
     font-size="9"
     fill="#c2185b"
     id="text80"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">• W_slot[j] - assignment</text>
  <text
     x="223.35071"
     y="170.47604"
     font-size="9"
     fill="#c2185b"
     id="text81"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal">• W_head - conclusion</text>
  <text
     xml:space="preserve"
     id="text82"
     style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:21.3333px;font-family:sans-serif;-inkscape-font-specification:'sans-serif, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-align:start;writing-mode:lr-tb;direction:ltr;white-space:pre;shape-inside:url(#rect82);display:inline;fill:#000000"
     transform="translate(-1112.6493,128.47604)" />
</svg>
